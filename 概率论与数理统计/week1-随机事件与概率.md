# 第一周：随机事件与概率

## 1. 课程目标
本周我们学习随机试验、样本空间、随机事件及事件的关系与运算。目标是理解概率的基本概念，为后续概率的定义与计算方法（古典概率、几何概率、条件概率等）打下基础。

## 2. 随机试验（Random Experiment）
- 定义：在相同条件下可重复进行、结果不确定但所有可能结果可以列举或描述的试验称为随机试验。
- 特点：可重复性、确定的试验程序、不确定的结果。

### 例子
1. 抛一枚硬币（得到正面或反面）。
2. 抛一枚骰子（结果为1到6）。
3. 从一副扑克牌中随机抽取一张。

## 3. 样本空间（Sample Space）
- 定义：随机试验所有可能结果所组成的集合，记为 \(\Omega\) 或 \(S\)。
- 如果 \(\omega\) 是样本点（基本事件），且 \(\omega\in\Omega\)。

### 示例样本空间
- 抛硬币：\(\Omega=\{H, T\}\)。
- 抛骰子：\(\Omega=\{1,2,3,4,5,6\}\)。
- 抽牌（不考虑花色顺序）：一副52张牌。

## 4. 随机事件（Event）
- 定义：样本空间的子集称为事件。事件可以包含一个或多个样本点。
- 记号：若事件为 \(A\)，则 \(A\subseteq\Omega\)。

### 事件类型
- 基本事件（原子事件）：只包含一个样本点，例如掷骰子得到3，事件为 \(\{3\}\)。
- 复合事件：包含多个样本点，例如掷骰子得到奇数，事件为 \(\{1,3,5\}\)。
- 必然事件：事件等于样本空间 \(\Omega\)。
- 不可能事件：空集 \(\varnothing\)。

## 5. 事件的关系与运算
设事件 \(A, B\subseteq\Omega\)。

- 包含：若所有 \(A\) 的元素均属于 \(B\)，则称 \(A\subseteq B\)。
- 相等：若 \(A\subseteq B\) 且 \(B\subseteq A\)，则 \(A=B\)。
- 并集：\(A\cup B=\{\omega: \omega\in A \text{ 或 } \omega\in B\}\)。
- 交集：\(A\cap B=\{\omega: \omega\in A \text{ 且 } \omega\in B\}\)。
- 差集：\(A\setminus B=\{\omega: \omega\in A \text{ 且 } \omega\notin B\}\)。
- 互斥（不相容）：若 \(A\cap B=\varnothing\)，称 \(A\) 与 \(B\) 互斥。
- 补集：相对于样本空间的补集记为 \(A^c=\Omega\setminus A\)。

### 运算律
- 交换律：\(A\cup B=B\cup A,\quad A\cap B=B\cap A\)。
- 结合律：\((A\cup B)\cup C=A\cup(B\cup C)\)，同理有交集的结合律。
- 分配律：\(A\cup(B\cap C)=(A\cup B)\cap(A\cup C)\)，\(A\cap(B\cup C)=(A\cap B)\cup(A\cap C)\)。
- 德摩根律：\((A\cup B)^c=A^c\cap B^c,\quad (A\cap B)^c=A^c\cup B^c\)。

## 6. 概率的直观概念与古典概型
- 概率是对事件发生不确定性的量化。直观上可以用长期频率来理解：若在相同条件下重复进行试验\(n\)次，事件\(A\)出现了\(n_A\)次，则相对频率\(n_A/n\)在大样本下趋于事件的概率。
- 古典概型的假设：样本空间中各个样本点等可能（常用于有限、对称的试验，如掷骰子、抽牌、抛硬币）。在古典概型下，若\(|\Omega|<\infty\)且各样点等可能，则
\[P(A)=\frac{|A|}{|\Omega|},\]
其中\(|A|\)表示事件\(A\)中样本点的个数。

### 古典概型举例
- 抛一枚公平硬币：\(|\Omega|=2\)，事件“正面”有1个有利样点，概率为\(1/2\)。
- 抽一张扑克牌（52张均等可能）：事件“抽到一张红桃”有13个有利样点，概率为\(13/52=1/4\)。

## 7. 概率的基本性质
设概率测度\(P\)定义在事件集合上，则应满足的公理（柯尔莫哥洛夫公理的初步形式）和常用性质：

- 非负性：对任意事件\(A\)，\(P(A)\ge 0\)。
- 规范化：\(P(\Omega)=1\)。
- 可列可加性（若事件两两互斥，则并集的概率等于各自概率之和）：若\(A_i\cap A_j=\varnothing\)对任意\(i\ne j\)成立，则
\[P\Big(\bigcup_{i}A_i\Big)=\sum_{i}P(A_i).\]

推论与常用公式：
- 补集公式：\(P(A^c)=1-P(A)\)。
- 单调性：若\(A\subseteq B\)，则\(P(A)\le P(B)\)。
- 加法公式（两事件）：
\[P(A\cup B)=P(A)+P(B)-P(A\cap B).\]

### 容斥原理（两、三事件）
- 两事件：上面给出。
- 三事件：
\[P(A\cup B\cup C)=P(A)+P(B)+P(C)-P(A\cap B)-P(A\cap C)-P(B\cap C)+P(A\cap B\cap C).\]

## 8. 计数原理（用于有限样本空间的概率计算）
在古典概型下，计算\(|\Omega|\)和\(|A|\)常用计数方法：

- 乘法原理（基本规则）：若一个试验可以分成两步，第一步有\(m\)种结果，第二步在第一步的每种结果下各有\(n\)种结果，则该复合试验共有\(m\times n\)种结果。
- 排列（有序）：从\(n\)个不同元素中取出\(r\)个并考虑顺序的取法数为\(P(n,r)=n(n-1)\cdots(n-r+1)=\dfrac{n!}{(n-r)!}\)。
- 组合（无序）：从\(n\)个不同元素中取出\(r\)个且不考虑顺序的取法数为\(C(n,r)=\dfrac{n!}{r!(n-r)!}\)。

## 9. 例题详解（概率计算）

### 例4（掷两个骰子求和的概率）
问题：掷两个公平骰子，求两骰子点数之和为7的概率。
解析：样本空间为有序对\(\Omega=\{(i,j):1\le i,j\le6\}\)，共有\(|\Omega|=36\)种等可能结果。和为7的有利结果为\((1,6),(2,5),(3,4),(4,3),(5,2),(6,1)\)，共6个。因此
\[P(\text{和为7})=\frac{6}{36}=\frac{1}{6}.\]

### 例5（抽牌概率）
问题：从一副52张牌中随机抽一张，求事件“抽到一张黑桃并且为A”的概率。
解析：有利样点只有一张（A\spadesuit），所以概率为\(1/52\)。如果问“抽到一张人头牌（J,Q,K）或红色牌”，可以使用加法公式并去掉交集部分：
红色牌数为26，人头牌数为12，两者交集为红色人头牌数6，所以概率为\((26+12-6)/52=32/52=8/13\)。

### 例6（互斥与独立的区分）
- 互斥：如果\(A\cap B=\varnothing\)，则\(P(A\cup B)=P(A)+P(B)\)。
- 独立：如果\(P(A\cap B)=P(A)P(B)\)。互斥通常不等于独立（除非某个事件概率为0或1）。

举例：抛一枚硬币两次，事件\(A\)：第一次为正面，\(B\)：第二次为正面。则\(P(A)=P(B)=1/2\)，且\(P(A\cap B)=1/4=P(A)P(B)\)，因此独立且不互斥。

## 10. 进一步的经典练习与答案（补充）

1. 抛三次公平硬币，求恰好两次正面的概率。
   - 解：样本空间大小为8，有利样点为\(\{HHT, HTH, THH\}\)，共3个。因此概率为\(3/8\)。

2. 从52张牌中任取一张，求抽到一张红桃或一张A的概率。
   - 解：红桃有13张，A有4张，两者交集（红桃A）有1张。由加法公式，概率为\((13+4-1)/52=16/52=4/13\)。

3. 抛两枚硬币，求至少有一枚为正面的概率。
   - 解：可以用补集法，事件“至少有一枚为正面”的补集是“两枚都是反面”，概率为\(1-1/4=3/4\)。

4. 在掷两个骰子的试验中，求两骰子点数和为偶数的概率。
   - 解：和为偶数当且仅当两骰子的点数同为奇数或同为偶数。奇数点有3种，偶数点有3种，所以有利组合数为\(3\times3+3\times3=18\)，故概率为\(18/36=1/2\)。

## 11. 练习题（供课后练习）

1. 从1到10这10个数中随机选取一个数，求选到质数的概率。
2. 抛四次硬币，求至少出现一次正面的概率。
3. 从一副牌中抽两张（不放回），求抽到两张都是红色的概率。

（答案在后面）

## 12. 练习题答案

1. 1到10中的质数为\(2,3,5,7\)，共4个，概率为\(4/10=2/5\)。
2. “至少出现一次正面”的补集是“四次都为反面”，概率为\(1-\frac{1}{16}=15/16\)。
3. 不放回抽两张，样本空间为C(52,2)等可能结果，或用条件概率：第一次抽红色概率为\(26/52=1/2\)，第二次在已抽到一张红色下概率为\(25/51\)，所以联合概率为\(\dfrac{1}{2}\times\dfrac{25}{51}=\dfrac{25}{102}\)。

## 13. 小结
- 本周掌握了随机试验、样本空间与事件的概念，熟练进行事件的并、交、差、补等运算，并能在古典概型下用计数方法计算概率。
- 为后续学习条件概率、随机变量及分布奠定基础。
## 6. 经典例题与解析

### 例1（掷硬币）
问题：抛两次公平硬币，试列出样本空间并写出事件“恰好有一次正面”的样本点。
解析：样本空间 \(\Omega=\{HH, HT, TH, TT\}\)。事件 \(A=\{HT, TH\}\)。

### 例2（掷骰子）
问题：掷一枚均匀骰子，令事件 \(A\)：掷得偶数，事件 \(B\)：掷得大于3的数。写出 \(A\cup B, A\cap B, A\setminus B, A^c\)。
解析：\(\Omega=\{1,2,3,4,5,6\}\)。
- \(A=\{2,4,6\}\)。
- \(B=\{4,5,6\}\)。
- \(A\cup B=\{2,4,5,6\}\)。
- \(A\cap B=\{4,6\}\)。
- \(A\setminus B=\{2\}\)。
- \(A^c=\{1,3,5\}\)。

### 例3（抽牌）
问题：从一副52张牌中随机抽一张，事件 \(A\)：抽到红桃，事件 \(B\)：抽到一张人头牌（J、Q、K）。写出 \(A\cap B\) 的含义并列举样点。
解析：\(A\cap B\) 表示抽到红桃且为人头牌，即 \(\{J\heartsuit, Q\heartsuit, K\heartsuit\}\)。

## 7. 练习题（含答案）

1. 抛三次公平硬币，写出样本空间，并求事件“至少出现两次正面”的样点集合。
   - 答案：\(\Omega=\{HHH, HHT, HTH, HTT, THH, THT, TTH, TTT\}\)，事件为 \(\{HHH, HHT, HTH, THH\}\)。

2. 在掷两个骰子的试验中，设事件 \(A\)：两骰子点数之和为7，\(B\)：至少有一个骰子为6。求 \(A\cap B\)。
   - 答案：\(A=\{(1,6),(2,5),(3,4),(4,3),(5,2),(6,1)\}\)，\(B=\{(1,6),(2,6),(3,6),(4,6),(5,6),(6,6),(6,1),(6,2),(6,3),(6,4),(6,5)\}\)，\(A\cap B=\{(1,6),(6,1)\}\)。

3. 设 \(\Omega=\{1,2,3,4,5,6\}\)，事件 \(A=\{1,2,3\}\)，\(B=\{3,4\}\)，求 \(A\cup B, A\cap B, A^c\)。
   - 答案：\(A\cup B=\{1,2,3,4\}\)，\(A\cap B=\{3\}\)，\(A^c=\{4,5,6\}\)。

## 8. 小结
- 随机试验是可重复、结果不确定的试验；样本空间包含所有可能结果；事件是样本空间的子集。
- 事件的基本运算：并、交、差、补，以及相关的代数律（交换律、结合律、分配律、德摩根律）。

## 14. 古典概型、几何概型与频率

### 古典概型回顾
- 古典概型假定有限样本空间中各样本点等可能。因此概率计算可用计数方法：
\[P(A)=\frac{|A|}{|\Omega|}.\]
- 适用场景：掷骰子、抽牌、掷硬币等对称问题。

### 几何概型（几何概率）
- 当样本空间不是离散可数而是连续（例如点在区间、平面或空间内随机取），且“等可能”对应于面积或长度等测度时，称为几何概型。
- 计算方法：用区域的测度（长度、面积、体积）之比来表示概率。若样本空间为集合\(S\)，事件为子集\(A\)，则
\[P(A)=\frac{\text{测度}(A)}{\text{测度}(S)}.\]
- 例子：在单位正方形上随机取一点，求到正方形中心距离小于1/2的概率。答案为小圆面积与正方形面积之比：\(\pi(1/2)^2/1=\pi/4\)。

注意：几何概型要求“等可能”与测度一致，且边界情况（测度为0 的集合）通常可忽略。

### 频率与频率的形式化定义
- 频率（relative frequency）是经验概率的一种表达：在相同条件下重复进行试验\(n\)次，事件\(A\)出现的次数为\(n_A\)，则频率为
\[f_n(A)=\frac{n_A}{n}.\]
- 频率的形式化定义通常与大数定律（Law of Large Numbers）相关：在理想独立重复试验下，随着试验次数\(n\to\infty\)，相对频率\(f_n(A)\)以概率趋于一个定值（即概率\(P(A)\)）。这给出频率-概率解释之间的联系。

### 频率的性质（经验层面）
- 有界性：对任意\(n\)，有\(0\le f_n(A)\le1\)。
- 可加性近似：若事件\(A,B\)互斥，则在同一次重复试验的大样本下，\(f_n(A\cup B)\approx f_n(A)+f_n(B)\)，误差随样本数增加而减小。
- 收敛性（大数定律）：在独立同分布的试验下，\(f_n(A)\)在概率意义上收敛到真实概率\(P(A)\)（若概率存在）。这为用实验频率估计概率提供理论依据。

## 15. 例题与练习（古典/几何/频率）

1. 古典例题：从一副牌中随机抽一张，求抽到黑桃或红桃的概率。
   - 解：黑桃与红桃分别各13张，合计26张，共52张，所以概率为\(26/52=1/2\)。

2. 几何例题：在单位正方形内随机取一点，求该点到左下角（0,0）距离小于1/2 的概率。
   - 解：满足条件的区域是以原点为中心的四分之一圆（注意落在正方形内），面积为 \(\pi(1/2)^2/4=\pi/16\)，正方形面积为1，所以概率为 \(\pi/16\)。（若题意为到中心距离小于1/2 则为圆面积比例 \(\pi/4\)——请根据题意确认）。

3. 频率例题：独立重复抛一枚公平硬币 1000 次，实验中正面出现了 523 次，估计正面概率并讨论误差。
   - 解：经验频率为 \(f_{1000}=523/1000=0.523\)。理论概率为 0.5，观察到的偏差为 0.023。根据中心极限定理，标准误约为 \(\sqrt{p(1-p)/n}=\sqrt{0.5\times0.5/1000}\approx0.016\)，因此偏差约为 1.4 个标准差（0.023/0.016），在合理波动范围内。

## 16. 小结
- 古典概型适用于有限且等可能的离散样本空间；几何概型用于连续且以测度均匀分布的情况。
- 频率提供了概率的经验估计方法，通过大数定律与中心极限定理可以描述频率与真实概率之间的关系与误差范围。


## 17. 深入补充：计数技巧、收敛定理与置信区间

### 计数技巧补充
- 分块计数（分步计数）：复杂问题可分解为若干独立步骤，分别计数再相乘。
- 排列组合简化：遇到重复元素或对称性时，注意除去等价计数（例如环排列或重复元素的排列）。
- 用补集与对称性减少计算：计算 A 的概率时若 A 的补集更易计算，可先求 P(A^c) 再用 1-P(A)。

### 大数定律（Law of Large Numbers）——直观与分类
- 弱大数定律（WLLN）：对于独立同分布的可积随机变量序列，样本平均在概率意义下收敛到期望值。
- 强大数定律（SLLN）：样本平均几乎必然（with probability 1）收敛到期望值。强律比弱律陈述更强的收敛模式。
- 意义：频率作为概率估计随着样本量增加而稳定，给出了频率-概率桥梁的理论依据。

### 中心极限定理（Central Limit Theorem, CLT）——近似分布
- 若 \(X_1,\dots,X_n\) 为独立同分布且具有有限期望\(\mu\)与有限方差\(\sigma^2\)，则样本平均的标准化量
\[Z_n=\frac{\overline{X}_n-\mu}{\sigma/\sqrt{n}}\]
在分布上趋于标准正态分布 \(N(0,1)\)（当 \(n\) 足够大时可用正态近似）。
- 在频率问题中把 Bernoulli 变量（取值0/1）带入可得到二项分布到正态分布的近似，从而估计频率的置信区间。

### 置信区间（以频率为例）
- 若我们观察到事件在 n 次试验中出现次数为 k，则频率为 \(\hat p=k/n\)。基于 CLT，当 n 足够大时，\(\hat p\) 的近似标准误为
\[\mathrm{SE}(\hat p)\approx\sqrt{\frac{\hat p(1-\hat p)}{n}}.\]
- 以 95% 置信区间为例：
\[\hat p\pm 1.96\times\mathrm{SE}(\hat p).\]
- 注意：当 p 接近 0 或 1 或 n 较小时，需要用精确的二项置信区间（如 Clopper–Pearson）而非正态近似。

### 蒙特卡洛演示与脚本说明
- 我添加了一个简单的 Python 脚本 `examples/monte_carlo_coin.py`，用于演示频率随样本数或重复次数的分布、计算样本均值与经验标准差并给出均值的置信区间。
- 在 Windows PowerShell（已安装 Python）中运行示例：
```powershell
python .\概率论与数理统计\examples\monte_carlo_coin.py -n 1000 -t 500 -p 0.5
```

### 额外练习（带解析要点）
1. 组合题：从 10 个不同信封中随机选择 3 个，求恰好包含信封 A 的概率。
   - 要点：总选择数 C(10,3)，包含 A 的有利选择 C(9,2)，概率为 C(9,2)/C(10,3)=\(\dfrac{36}{120}=3/10\)。

2. 几何题：在边长为 2 的正方形内随机取一点，求其到正方形中心距离小于 0.5 的概率。
   - 要点：目标区域为半径 0.5 的圆，圆面积 \(\pi(0.5)^2=0.25\pi\)，总面积为 4，概率为 \(0.25\pi/4=\pi/16\)。

3. 置信区间题：在 n=200 次独立抛硬币实验中，正面出现 110 次。计算 95% 置信区间。
   - 解要点：\(\hat p=110/200=0.55\)，标准误约为 \(\sqrt{0.55\times0.45/200}\approx0.0349\)，95% 区间约为 \(0.55\pm1.96\times0.0349=(0.481,0.619)\)。

## 18. 参考与延伸
- 经典教材：Grimmett & Stirzaker, Probability and Random Processes；Ross, A First Course in Probability。
- 推荐练习：实现蒙特卡洛模拟并观察频率随 n 增大时的收敛行为，比较正态近似置信区间与精确二项置信区间。

